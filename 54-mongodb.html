<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>A.54. Golang NoSQL MongoDB - Dasar Pemrograman Golang</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="gitbook/style.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-highlight/website.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><link href="styles/website.css"rel="stylesheet"><meta content="UZnxS2Dk3fm2_Elms3a__56Q_oQ3sQ1h0SVXXlHSmbE"name="google-site-verification"><meta content="https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"name="og:image"><meta content="https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"name="twitter:image"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="55-unit-test.html"rel="next"/><link href="53-sql.html"rel="prev"/></head><body><div class="book"><div class="book-summary"><div role="search"id="book-search-input"><input placeholder="Type to search"type="text"/></div><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="./"><a href="./">Introduction</a></li><li class="chapter"data-level="1.2"><span>A. Pemrograman Go Dasar</span><ul class="articles"><li class="chapter"data-level="1.2.1"data-path="1-berkenalan-dengan-golang.html"><a href="1-berkenalan-dengan-golang.html">A.1. Berkenalan Dengan Golang</a></li><li class="chapter"data-level="1.2.2"data-path="2-instalasi-golang.html"><a href="2-instalasi-golang.html">A.2. Instalasi Golang</a></li><li class="chapter"data-level="1.2.3"data-path="3-gopath-dan-workspace.html"><a href="3-gopath-dan-workspace.html">A.3. GOPATH Dan Workspace</a></li><li class="chapter"data-level="1.2.4"data-path="4-instalasi-editor.html"><a href="4-instalasi-editor.html">A.4. Instalasi Editor</a></li><li class="chapter"data-level="1.2.5"data-path="5-go-command.html"><a href="5-go-command.html">A.5. Command</a></li><li class="chapter"data-level="1.2.6"data-path="6-hello-world.html"><a href="6-hello-world.html">A.6. Program Pertama: Hello World</a></li><li class="chapter"data-level="1.2.7"data-path="7-komentar.html"><a href="7-komentar.html">A.7. Komentar</a></li><li class="chapter"data-level="1.2.8"data-path="8-variabel.html"><a href="8-variabel.html">A.8. Variabel</a></li><li class="chapter"data-level="1.2.9"data-path="9-tipe-data.html"><a href="9-tipe-data.html">A.9. Tipe Data</a></li><li class="chapter"data-level="1.2.10"data-path="10-konstanta.html"><a href="10-konstanta.html">A.10. Konstanta</a></li><li class="chapter"data-level="1.2.11"data-path="11-operator.html"><a href="11-operator.html">A.11. Operator</a></li><li class="chapter"data-level="1.2.12"data-path="12-seleksi-kondisi.html"><a href="12-seleksi-kondisi.html">A.12. Seleksi Kondisi</a></li><li class="chapter"data-level="1.2.13"data-path="13-perulangan.html"><a href="13-perulangan.html">A.13. Perulangan</a></li><li class="chapter"data-level="1.2.14"data-path="14-array.html"><a href="14-array.html">A.14. Array</a></li><li class="chapter"data-level="1.2.15"data-path="15-slice.html"><a href="15-slice.html">A.15. Slice</a></li><li class="chapter"data-level="1.2.16"data-path="16-map.html"><a href="16-map.html">A.16. Map</a></li><li class="chapter"data-level="1.2.17"data-path="17-fungsi.html"><a href="17-fungsi.html">A.17. Fungsi</a></li><li class="chapter"data-level="1.2.18"data-path="18-fungsi-multiple-return.html"><a href="18-fungsi-multiple-return.html">A.18. Fungsi Multiple Return</a></li><li class="chapter"data-level="1.2.19"data-path="19-fungsi-variadic.html"><a href="19-fungsi-variadic.html">A.19. Fungsi Variadic</a></li><li class="chapter"data-level="1.2.20"data-path="20-fungsi-closure.html"><a href="20-fungsi-closure.html">A.20. Fungsi Closure</a></li><li class="chapter"data-level="1.2.21"data-path="21-fungsi-sebagai-parameter.html"><a href="21-fungsi-sebagai-parameter.html">A.21. Fungsi Sebagai parameter</a></li><li class="chapter"data-level="1.2.22"data-path="22-pointer.html"><a href="22-pointer.html">A.22. Pointer</a></li><li class="chapter"data-level="1.2.23"data-path="23-struct.html"><a href="23-struct.html">A.23. Struct</a></li><li class="chapter"data-level="1.2.24"data-path="24-method.html"><a href="24-method.html">A.24. Method</a></li><li class="chapter"data-level="1.2.25"data-path="25-properti-public-dan-private.html"><a href="25-properti-public-dan-private.html">A.25. Property Public & Private</a></li><li class="chapter"data-level="1.2.26"data-path="26-interface.html"><a href="26-interface.html">A.26. Interface</a></li><li class="chapter"data-level="1.2.27"data-path="27-interface-kosong.html"><a href="27-interface-kosong.html">A.27. Interface Kosong</a></li><li class="chapter"data-level="1.2.28"data-path="28-reflect.html"><a href="28-reflect.html">A.28. Reflect</a></li><li class="chapter"data-level="1.2.29"data-path="29-goroutine.html"><a href="29-goroutine.html">A.29. Goroutine</a></li><li class="chapter"data-level="1.2.30"data-path="30-channel.html"><a href="30-channel.html">A.30. Channel</a></li><li class="chapter"data-level="1.2.31"data-path="31-buffered-channel.html"><a href="31-buffered-channel.html">A.31. Buffered Channel</a></li><li class="chapter"data-level="1.2.32"data-path="32-channel-select.html"><a href="32-channel-select.html">A.32. Channel - Select</a></li><li class="chapter"data-level="1.2.33"data-path="33-channel-range-close.html"><a href="33-channel-range-close.html">A.33. Channel - Range & Close</a></li><li class="chapter"data-level="1.2.34"data-path="34-channel-timeout.html"><a href="34-channel-timeout.html">A.34. Channel - Timeout</a></li><li class="chapter"data-level="1.2.35"data-path="35-defer-exit.html"><a href="35-defer-exit.html">A.35. Defer & Exit</a></li><li class="chapter"data-level="1.2.36"data-path="36-error-panic-recover.html"><a href="36-error-panic-recover.html">A.36. Error, Panic, & Recover</a></li><li class="chapter"data-level="1.2.37"data-path="37-string-format.html"><a href="37-string-format.html">A.37. Layout Format String</a></li><li class="chapter"data-level="1.2.38"data-path="38-time.html"><a href="38-time.html">A.38. Time, Parsing Time, & Format Time</a></li><li class="chapter"data-level="1.2.39"data-path="39-timer.html"><a href="39-timer.html">A.39. Timer, Ticker, & Scheduler</a></li><li class="chapter"data-level="1.2.40"data-path="40-data-type-conversion.html"><a href="40-data-type-conversion.html">A.40. Konversi Antar Tipe Data</a></li><li class="chapter"data-level="1.2.41"data-path="41-strings.html"><a href="41-strings.html">A.41. Fungsi String</a></li><li class="chapter"data-level="1.2.42"data-path="42-regex.html"><a href="42-regex.html">A.42. Regex</a></li><li class="chapter"data-level="1.2.43"data-path="43-encoding-base64.html"><a href="43-encoding-base64.html">A.43. Encode - Decode Base64</a></li><li class="chapter"data-level="1.2.44"data-path="44-hash-sha1.html"><a href="44-hash-sha1.html">A.44. Hash Sha1</a></li><li class="chapter"data-level="1.2.45"data-path="45-command-line-args-flag.html"><a href="45-command-line-args-flag.html">A.45. Arguments & Flag</a></li><li class="chapter"data-level="1.2.46"data-path="46-exec.html"><a href="46-exec.html">A.46. Exec</a></li><li class="chapter"data-level="1.2.47"data-path="47-file.html"><a href="47-file.html">A.47. File</a></li><li class="chapter"data-level="1.2.48"data-path="48-web.html"><a href="48-web.html">A.48. Web</a></li><li class="chapter"data-level="1.2.49"data-path="49-url-parsing.html"><a href="49-url-parsing.html">A.49. URL Parsing</a></li><li class="chapter"data-level="1.2.50"data-path="50-json.html"><a href="50-json.html">A.50. JSON</a></li><li class="chapter"data-level="1.2.51"data-path="51-web-json-api.html"><a href="51-web-json-api.html">A.51. Web Service API (JSON Data)</a></li><li class="chapter"data-level="1.2.52"data-path="52-http-request.html"><a href="52-http-request.html">A.52. HTTP Request</a></li><li class="chapter"data-level="1.2.53"data-path="53-sql.html"><a href="53-sql.html">A.53. SQL</a></li><li class="chapter active"data-level="1.2.54"data-path="54-mongodb.html"><a href="54-mongodb.html">A.54. NoSQL MongoDB</a></li><li class="chapter"data-level="1.2.55"data-path="55-unit-test.html"><a href="55-unit-test.html">A.55. Unit Test</a></li><li class="chapter"data-level="1.2.56"data-path="56-waitgroup.html"><a href="56-waitgroup.html">A.56. WaitGroup</a></li><li class="chapter"data-level="1.2.57"data-path="57-mutex.html"><a href="57-mutex.html">A.57. Mutex</a></li><li class="chapter"data-level="1.2.58"data-path="A-58-go-vendoring.html"><a href="A-58-go-vendoring.html">A.58. Go Vendoring</a></li><li class="chapter"data-level="1.2.59"data-path="A-59-go-dep.html"><a href="A-59-go-dep.html">A.59. Dep - Go Dependency Management Tool</a></li><li class="chapter"data-level="1.2.60"data-path="A-60-go-modules.html"><a href="A-60-go-modules.html">A.60. Go Modules</a></li></ul></li><li class="chapter"data-level="1.3"><span>B. Pemrograman Web Go Dasar</span><ul class="articles"><li class="chapter"data-level="1.3.1"data-path="B-1-golang-web-hello-world.html"><a href="B-1-golang-web-hello-world.html">B.1. Golang Web App: Hello World</a></li><li class="chapter"data-level="1.3.2"data-path="B-2-routing-http-handlefunc.html"><a href="B-2-routing-http-handlefunc.html">B.2. Routing http.HandleFunc</a></li><li class="chapter"data-level="1.3.3"data-path="B-3-routing-static-assets.html"><a href="B-3-routing-static-assets.html">B.3. Routing Static Assets</a></li><li class="chapter"data-level="1.3.4"data-path="B-4-template-render-html.html"><a href="B-4-template-render-html.html">B.4. Template: Render HTML Template</a></li><li class="chapter"data-level="1.3.5"data-path="B-5-template-render-partial-html.html"><a href="B-5-template-render-partial-html.html">B.5. Template: Render Partial HTML Template</a></li><li class="chapter"data-level="1.3.6"data-path="B-6-template-actions-variables.html"><a href="B-6-template-actions-variables.html">B.6. Template: Actions & Variables</a></li><li class="chapter"data-level="1.3.7"data-path="B-7-template-functions.html"><a href="B-7-template-functions.html">B.7. Template: Functions</a></li><li class="chapter"data-level="1.3.8"data-path="B-8-template-custom-functions.html"><a href="B-8-template-custom-functions.html">B.8. Template: Custom Functions</a></li><li class="chapter"data-level="1.3.9"data-path="B-9-render-specific-html-template.html"><a href="B-9-render-specific-html-template.html">B.9. Template: Render Specific HTML Template</a></li><li class="chapter"data-level="1.3.10"data-path="B-10-render-html-string.html"><a href="B-10-render-html-string.html">B.10. Template: Render HTML String</a></li><li class="chapter"data-level="1.3.11"data-path="B-11-http-method.html"><a href="B-11-http-method.html">B.11. HTTP Method: POST & GET</a></li><li class="chapter"data-level="1.3.12"data-path="B-12-form-value.html"><a href="B-12-form-value.html">B.12. Form Value</a></li><li class="chapter"data-level="1.3.13"data-path="B-13-form-upload-file.html"><a href="B-13-form-upload-file.html">B.13. Form Upload File</a></li><li class="chapter"data-level="1.3.14"data-path="B-14-ajax-json-payload.html"><a href="B-14-ajax-json-payload.html">B.14. AJAX JSON Payload</a></li><li class="chapter"data-level="1.3.15"data-path="B-15-ajax-json-response.html"><a href="B-15-ajax-json-response.html">B.15. AJAX JSON Response</a></li><li class="chapter"data-level="1.3.16"data-path="B-16-ajax-multi-upload.html"><a href="B-16-ajax-multi-upload.html">B.16. AJAX Multiple File Upload</a></li><li class="chapter"data-level="1.3.17"data-path="B-17-download-file.html"><a href="B-17-download-file.html">B.17. Download File</a></li><li class="chapter"data-level="1.3.18"data-path="B-18-http-basic-auth.html"><a href="B-18-http-basic-auth.html">B.18. HTTP Basic Auth</a></li><li class="chapter"data-level="1.3.19"data-path="B-19-middleware-using-http-handler.html"><a href="B-19-middleware-using-http-handler.html">B.19. Middleware http.Handler</a></li><li class="chapter"data-level="1.3.20"data-path="B-20-custom-mux-multiplexer.html"><a href="B-20-custom-mux-multiplexer.html">B.20. Custom Multiplexer</a></li><li class="chapter"data-level="1.3.21"data-path="B-21-cookie.html"><a href="B-21-cookie.html">B.21. HTTP Cookie</a></li><li class="chapter"data-level="1.3.22"data-path="B-22-configuration-file.html"><a href="B-22-configuration-file.html">B.22. Configuration File</a></li><li class="chapter"data-level="1.3.23"data-path="B-23-server-handle-cancelled-http-request.html"><a href="B-23-server-handle-cancelled-http-request.html">B.23. Server Handler untuk Cancelled Client HTTP Request</a></li></ul></li><li class="chapter"data-level="1.4"><span>C. Pemrograman Go Lanjut</span><ul class="articles"><li class="chapter"data-level="1.4.1"data-path="C-1-echo-routing.html"><a href="C-1-echo-routing.html">C.1. Echo Framework & Routing</a></li><li class="chapter"data-level="1.4.2"data-path="C-2-parsing-http-request-payload-echo.html"><a href="C-2-parsing-http-request-payload-echo.html">C.2. Parsing HTTP Request Payload (Echo)</a></li><li class="chapter"data-level="1.4.3"data-path="C-3-http-request-payload-validation.html"><a href="C-3-http-request-payload-validation.html">C.3. HTTP Request Payload Validation (Validator v9, Echo)</a></li><li class="chapter"data-level="1.4.4"data-path="C-4-http-error-handling.html"><a href="C-4-http-error-handling.html">C.4. HTTP Error Handling (Validator v9, Echo)</a></li><li class="chapter"data-level="1.4.5"data-path="C-5-echo-template-rendering.html"><a href="C-5-echo-template-rendering.html">C.5. Template Rendering in Echo</a></li><li class="chapter"data-level="1.4.6"data-path="C-6-advanced-middleware-and-logging.html"><a href="C-6-advanced-middleware-and-logging.html">C.6. Advanced Middleware & Logging (Logrus, Echo Logger)</a></li><li class="chapter"data-level="1.4.7"data-path="C-7-flag-parser.html"><a href="C-7-flag-parser.html">C.7. CLI Flag Parser (Kingpin)</a></li><li class="chapter"data-level="1.4.8"data-path="C-8-advanced-configuration-file.html"><a href="C-8-advanced-configuration-file.html">C.8. Advanced Configuration File (Viper)</a></li><li class="chapter"data-level="1.4.9"data-path="C-9-securecookie.html"><a href="C-9-securecookie.html">C.9. Secure Cookie (Gorilla Securecookie)</a></li><li class="chapter"data-level="1.4.10"data-path="C-10-session.html"><a href="C-10-session.html">C.10. Session (Gorilla Session)</a></li><li class="chapter"data-level="1.4.11"data-path="C-12-cors-preflight-request.html"><a href="C-12-cors-preflight-request.html">C.12. CORS & Preflight Request</a></li><li class="chapter"data-level="1.4.12"data-path="C-13-csrf.html"><a href="C-13-csrf.html">C.13. CSRF</a></li><li class="chapter"data-level="1.4.13"data-path="C-14-secure-middleware.html"><a href="C-14-secure-middleware.html">C.14. Secure Middleware</a></li><li class="chapter"data-level="1.4.14"data-path="C-15-http-gzip-compression.html"><a href="C-15-http-gzip-compression.html">C.15. HTTP Gzip Compression (gziphandler)</a></li><li class="chapter"data-level="1.4.15"data-path="C-16-send-email.html"><a href="C-16-send-email.html">C.16. Send Mail (net/smtp, Gomail v2)</a></li><li class="chapter"data-level="1.4.16"data-path="C-17-read-write-excel-xlsx-file.html"><a href="C-17-read-write-excel-xlsx-file.html">C.17. Read & Write Excel XLSX File (Excelize)</a></li><li class="chapter"data-level="1.4.17"data-path="C-18-write-pdf-file.html"><a href="C-18-write-pdf-file.html">C.18. Write PDF File (gofpdf)</a></li><li class="chapter"data-level="1.4.18"data-path="C-19-convert-html-to-pdf.html"><a href="C-19-convert-html-to-pdf.html">C.19. Convert HTML to PDF (go-wkhtmltopdf)</a></li><li class="chapter"data-level="1.4.19"data-path="C-20-scraping-parsing-html.html"><a href="C-20-scraping-parsing-html.html">C.20. Scraping & Parsing HTML (goquery)</a></li><li class="chapter"data-level="1.4.20"data-path="C-21-xml-parser.html"><a href="C-21-xml-parser.html">C.21. Parse & Generate XML (etree)</a></li><li class="chapter"data-level="1.4.21"data-path="C-22-https-tls.html"><a href="C-22-https-tls.html">C.22. HTTPS/TLS Web Server</a></li><li class="chapter"data-level="1.4.22"data-path="C-23-http2-server-push.html"><a href="C-23-http2-server-push.html">C.23. HTTP/2 & HTTP/2 Server Push</a></li><li class="chapter"data-level="1.4.23"data-path="C-24-client-http-request.html"><a href="C-24-client-http-request.html">C.24. Client HTTP Request</a></li><li class="chapter"data-level="1.4.24"data-path="C-25-secure-insecure-client-http-request.html"><a href="C-25-secure-insecure-client-http-request.html">C.25. Secure & Insecure Client HTTP Request</a></li><li class="chapter"data-level="1.4.25"data-path="C-26-golang-ftp.html"><a href="C-26-golang-ftp.html">C.26. FTP</a></li><li class="chapter"data-level="1.4.26"data-path="C-27-golang-ssh-sftp.html"><a href="C-27-golang-ssh-sftp.html">C.27. SSH & SFTP</a></li><li class="chapter"data-level="1.4.27"data-path="C-28-golang-web-socket.html"><a href="C-28-golang-web-socket.html">C.28. Web Socket: Chatting App</a></li><li class="chapter"data-level="1.4.28"data-path="C-29-golang-protobuf-implementation.html"><a href="C-29-golang-protobuf-implementation.html">C.29. Protobuf</a></li><li class="chapter"data-level="1.4.29"data-path="C-30-golang-grpc-protobuf.html"><a href="C-30-golang-grpc-protobuf.html">C.30. gRPC + Protobuf</a></li><li class="chapter"data-level="1.4.30"data-path="C-31-golang-context.html"><a href="C-31-golang-context.html">C.31. Context: Value, Timeout, & Cancellation</a></li><li class="chapter"data-level="1.4.31"data-path="C-32-golang-jwt.html"><a href="C-32-golang-jwt.html">C.32. JSON Web Token (JWT)</a></li><li class="chapter"data-level="1.4.32"data-path="C-33-golang-ldap-authentication.html"><a href="C-33-golang-ldap-authentication.html">C.33. LDAP Authentication</a></li></ul></li><li><a href="https://www.gitbook.com"target="blank"class="gitbook-link">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><a href=".">A.54. NoSQL MongoDB</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="markdown-section normal"><h1 id="a54-nosql-mongodb">A.54. NoSQL MongoDB</h1><p>Go tidak menyediakan interface generic untuk NoSQL, jadi implementasi driver tiap brand NoSQL di Go biasanya berbeda satu dengan lainnya.</p><p>Pada bab ini kita akan belajar cara berkomunikasi dengan NoSQL MongoDB server menggunakan official driver untuk go, yaitu <a href="https://github.com/mongodb/mongo-go-driver"target="_blank">mongo-go-driver</a>.</p><h2 id="a541-persiapan">A.54.1. Persiapan</h2><p>Ada beberapa hal yang perlu disiapkan sebelum mulai masuk ke bagian coding.</p><ol><li><p>Instal mongo-go-driver menggunakan <code>go get</code>.</p><pre><code>go get https://github.com/mongodb/mongo-go-driver
</code></pre></li><li><p>Pastikan sudah terinstal MongoDB di komputer anda, dan jangan lupa untuk menjalankan daemon-nya. Jika belum, <a href="ihttps://www.mongodb.org/downloads"target="_blank">download</a> dan install terlebih dahulu.</p></li><li><p>Instal juga MongoDB GUI untuk mempermudah browsing data. Bisa menggunakan <a href="http://3t.io/mongochef/"target="_blank">MongoChef</a>, <a href="http://robomongo.org/"target="_blank">Robomongo</a>, atau lainnya.</p></li></ol><h2 id="a542-insert-data">A.54.2. Insert Data</h2><p>Cara insert data ke mongodb via Go tidak terlalu sulit. Kita akan mempelajarinya dengan cara praktek langsung. Pertama-tama silakan import package yang dibutuhkan.</p><pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">&quot;context&quot;</span>
    <span class="hljs-string">&quot;fmt&quot;</span>
    <span class="hljs-string">&quot;log&quot;</span>
    <span class="hljs-string">&quot;time&quot;</span>

    <span class="hljs-string">&quot;go.mongodb.org/mongo-driver/mongo&quot;</span>
    <span class="hljs-string">&quot;go.mongodb.org/mongo-driver/mongo/options&quot;</span>
    <span class="hljs-string">&quot;go.mongodb.org/mongo-driver/bson&quot;</span>
)
</code></pre><p>Siapkan satu object context dan struct <code>student</code>. Rencananya satu buah document kita buat sebagai satu buah objek <code>student</code>.</p><p>Perlu diketahui bahwa pada bab ini tidak dijelaskan tentang apa itu context. Silakan merujuk ke <a href="C-31-golang-context.html">Bab C.31. Context: Value, Timeout, &amp; Cancellation</a> untuk mempelajarinya. Menggunakan satu context background untuk semua operasi sangat tidak dianjurkan, tapi pada bab ini kita terapkan demikian agar tidak menambah kebingungan pembaca yang masih proses belajar. Context sendiri fungsinya sangat banyak, untuk kasus sejenis biasanya digunakan untuk handle operation timeout atau lainnya.</p><pre><code class="lang-go"><span class="hljs-keyword">var</span> ctx = context.Background()

<span class="hljs-keyword">type</span> student <span class="hljs-keyword">struct</span> {
    Name  <span class="hljs-keyword">string</span> <span class="hljs-string">`bson:&quot;name&quot;`</span>
    Grade <span class="hljs-keyword">int</span>    <span class="hljs-string">`bson:&quot;Grade&quot;`</span>
}
</code></pre><p>Tag <code>bson</code> pada property struct digunakan sebagai penentu nama field ketika data disimpan ke dalam collection. Jika sebuah property tidak memiliki tag bson, secara default nama field adalah sama dengan nama property hanya saja lowercase. Untuk customize nama field, gunakan tag <code>bson</code>.</p><p>Pada contoh di atas, property <code>Name</code> ditentukan nama field mongo-nya sebagai <code>name</code>, dan <code>Grade</code> sebagai <code>Grade</code>.</p><p>Selanjutnya siapkan fungsi untuk membuat satu buah mongo connection. Dari objek connection diambil object database, kemudian dijadikan sebagai nilai balik fungsi.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> connect() (*mongo.Database, error) {
    clientOptions := options.Client()
    clientOptions.ApplyURI(<span class="hljs-string">&quot;mongodb://localhost:27017&quot;</span>)
    client, err := mongo.NewClient(client)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
    }

    err = client.Connect(ctx)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
    }

    <span class="hljs-keyword">return</span> client.Database(<span class="hljs-string">&quot;belajar_golang&quot;</span>), <span class="hljs-literal">nil</span>
}
</code></pre><p>Fungsi <code>mongo.NewClient()</code> digunakan untuk meng-inisialisasi koneksi database dari client ke server. Fungsi tersebut memerlukan parameter bertipe <code>*options.ClientOptions</code>. Pada client options mongo connection string perlu di set (lewat method <code>.ApplyURI()</code>).</p><blockquote><p>Silakan sesuaikan connection string dengan mongo db server yang dipergunakan. Lebih jelasnya silakan merujuk ke <a href="https://docs.mongodb.com/manual/reference/connection-string/"target="_blank">MongoDB Documentation: Connection String URI Format</a>.</p></blockquote><p>Dari object client, panggil method <code>.Connect()</code> untuk inisialisasi koneksi ke db server. Setelah itu panggil method <code>.Database()</code> untuk set database yang aktif.</p><p>Lanjut buat fungsi yang didalamnya berisikan kode untuk insert data ke mongodb, lalu panggil fungsi tersebut di <code>main()</code>.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> insert() {
    db, err := connect()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    _, err = db.Collection(<span class="hljs-string">&quot;student&quot;</span>).InsertOne(ctx, student{<span class="hljs-string">&quot;Wick&quot;</span>, <span class="hljs-number">2</span>})
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    _, err = db.Collection(<span class="hljs-string">&quot;student&quot;</span>).InsertOne(ctx, student{<span class="hljs-string">&quot;Ethan&quot;</span>, <span class="hljs-number">2</span>})
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    fmt.Println(<span class="hljs-string">&quot;Insert success!&quot;</span>)
}

<span class="hljs-keyword">func</span> main() {
    insert()
}
</code></pre><p>Fungsi <code>connect()</code> mengembalikan objek bertipe <code>*mongo.Database</code>. Dari objek tersebut akses method <code>.Collection()</code> lalu chain dengan method lainnya untuk melakukan operasi database, kurang lebih skema statement-nya sama seperti operasi mongodb.</p><p>Sebagai contoh, pada kode di atas <code>.InsertOne()</code> digunakan untuk insert satu data ke database. Perbandingannya kurang lebih seperti berikut:</p><pre><code class="lang-js"><span class="hljs-comment">// mongodb</span>
db.getCollection(<span class="hljs-string">&quot;student&quot;</span>).insertOne({ name: <span class="hljs-string">&quot;Wick&quot;</span>, Grade: <span class="hljs-number">2</span> })

<span class="hljs-comment">// mongo-do-driver</span>
db.Collection(<span class="hljs-string">&quot;student&quot;</span>).InsertOne(ctx, student{ name: <span class="hljs-string">&quot;Wick&quot;</span>, Grade: <span class="hljs-number">2</span>})
</code></pre><p>Perlu diketahui, bahwa di mongo-go-driver setiap operasi biasanya membutuhkan objek context untuk disisipkan sebagai parameter pertama. Pada contoh di atas kita gunakan variabel <code>ctx</code> yang sudah dideklarasikan sebelumnya.</p><p><img alt="Insert mongo"src="images/A.54_2_insert.png"></p><h2 id="a543-membaca-data">A.54.3. Membaca Data</h2><p>Method <code>.Find()</code> digunakan untuk membaca atau mencari data. Method ini mengembalikan objek cursor, objek ini harus digunakan dalam perulangan untuk mengambil data yang ditemukan.</p><p>Dalam pencarian, sisipkan query atau filter sebagai parameter ke-dua method <code>.Find()</code>.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> find() {
    db, err := connect()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    csr, err := db.Collection(<span class="hljs-string">&quot;student&quot;</span>).Find(ctx, bson.M{<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>})
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }
    <span class="hljs-keyword">defer</span> csr.Close(ctx)

    result := <span class="hljs-built_in">make</span>([]student, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">for</span> csr.Next(ctx) {
        <span class="hljs-keyword">var</span> row student
        err := csr.Decode(&amp;row)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            log.Fatal(err.Error())
        }

        result = <span class="hljs-built_in">append</span>(result, row)
    }

    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result) &gt; <span class="hljs-number">0</span> {
        fmt.Println(<span class="hljs-string">&quot;Name  :&quot;</span>, result[<span class="hljs-number">0</span>].Name)
        fmt.Println(<span class="hljs-string">&quot;Grade :&quot;</span>, result[<span class="hljs-number">0</span>].Grade)
    }
}

<span class="hljs-keyword">func</span> main() {
    find()
}
</code></pre><p>Query selector ditulis dalam tipe <code>bson.M</code>. Tipe ini sebenarnya adalah alias dari <code>map[string]interface{}</code>.</p><p>Cara untuk mendapatkan semua rows hasil pencarian kursor adalah dengan mengiterasi method <code>.Next()</code> dengan didalamnya method <code>.Decode()</code> dipanggil untuk retrieve datanya. Setelah itu data yang sudah terampil di-append ke slice.</p><p>Selain method <code>.Find()</code> ada juga <code>.FindOne()</code>, silakan cek dokumentasi lebih jelasnya.</p><p><img alt="Pencarian data"src="images/A.54_3_find.png"></p><p>Berikut adalah skema perbandingan contoh operasi get data menggunakan mongo query vs mongo-go-driver:</p><pre><code class="lang-js"><span class="hljs-comment">// mongodb</span>
db.getCollection(<span class="hljs-string">&quot;student&quot;</span>).find({<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>})

<span class="hljs-comment">// mongo-do-driver</span>
db.Collection(<span class="hljs-string">&quot;student&quot;</span>).Find(ctx, bson.M{<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>})
</code></pre><h2 id="a544-update-data">A.54.4. Update Data</h2><p>Method <code>.Update()</code> digunakan untuk update data (jika update hanya diinginkan untuk berlaku pada 1 dokumen saja, maka gunakan <code>.UpdateOne()</code>). Method <code>.Update()</code> memerlukan 3 buah parameter dalam pemanggilannya.</p><ol><li>Parameter pertama, objek context</li><li>Parameter kedua adalah query kondisi yang mengacu ke data mana yang ingin di update</li><li>Parameter ketiga adalah perubahan datanya.</li></ol><p>Di bawah ini adalah contok implementasi method <code>Update()</code>.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> update() {
    db, err := connect()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    <span class="hljs-keyword">var</span> selector = bson.M{<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>}
    <span class="hljs-keyword">var</span> changes = student{<span class="hljs-string">&quot;John Wick&quot;</span>, <span class="hljs-number">2</span>}
    _, err = db.Collection(<span class="hljs-string">&quot;student&quot;</span>).UpdateOne(ctx, selector, bson.M{<span class="hljs-string">&quot;$set&quot;</span>: changes})
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    fmt.Println(<span class="hljs-string">&quot;Update success!&quot;</span>)
}

<span class="hljs-keyword">func</span> main() {
    update()
}
</code></pre><p>Jalankan kode di atas, lalu cek lewat Mongo GUI apakah data berubah.</p><p><img alt="Update data"src="images/A.54_4_update.png"></p><p>Berikut adalah skema perbandingan query vs mongo-go-driver dari operasi di atas.</p><pre><code class="lang-js"><span class="hljs-comment">// mongodb</span>
db.getCollection(<span class="hljs-string">&quot;student&quot;</span>).update({<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>}, { <span class="hljs-string">&quot;$set&quot;</span>: {<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>, <span class="hljs-string">&quot;Grade&quot;</span>: <span class="hljs-number">2</span>} })

<span class="hljs-comment">// mongo-do-driver</span>
db.Collection(<span class="hljs-string">&quot;student&quot;</span>).UpdateOne(ctx, bson.M{<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Wick&quot;</span>}, bson.M{<span class="hljs-string">&quot;$set&quot;</span>: student{<span class="hljs-string">&quot;John Wick&quot;</span>, <span class="hljs-number">2</span>}})
</code></pre><p>Selain method <code>.UpdateOne()</code> ada juga method <code>.UpdateMany()</code>, kegunaan masing-masing bisa dilihat dari nama fungsinya.</p><h2 id="a545-menghapus-data">A.54.5. Menghapus Data</h2><p>Untuk menghapus data gunakan method <code>.DeleteOne()</code> atau <code>.DeleteMany()</code>.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> remove() {
    db, err := connect()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    <span class="hljs-keyword">var</span> selector = bson.M{<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;John Wick&quot;</span>}
    _, err = db.Collection(<span class="hljs-string">&quot;student&quot;</span>).DeleteOne(ctx, selector)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    fmt.Println(<span class="hljs-string">&quot;Remove success!&quot;</span>)
}

<span class="hljs-keyword">func</span> main() {
    remove()
}
</code></pre><p>Hasil dari kode di atas, 2 data yang sebelumnya sudah di-insert kini tinggal satu saja.</p><p><img alt="Menghapus data"src="images/A.54_5_remove.png"></p><p>Berikut adalah skema perbandingan query vs mongo-go-driver dari operasi di atas.</p><pre><code class="lang-js"><span class="hljs-comment">// mongodb</span>
db.getCollection(<span class="hljs-string">&quot;student&quot;</span>).delete({<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;John Wick&quot;</span>})

<span class="hljs-comment">// mongo-do-driver</span>
db.Collection(<span class="hljs-string">&quot;student&quot;</span>).DeleteMany(ctx, bson.M{<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;John Wick&quot;</span>})
</code></pre><h2 id="a546-aggregate-data">A.54.6. Aggregate Data</h2><p>Agregasi data menggunakan driver ini juga cukup mudah, caranya tinggal gunakan method <code>.Aggregate()</code> dan sisipkan pipeline query sebagai argument ke-2 pemanggilan method. Eksekusi method tersebut mengembalikan objek cursor. Selebihnya capture result dengan cara yang sama seperti capture cursor operasi <code>.Find()</code>.</p><p>Pipeline sendiri bisa dituliskan langsung dalam <code>[]bson.M</code>, atau bisa tulis dalam bentuk string dan unmarshal ke <code>[]bson.M</code>.</p><pre><code class="lang-go">pipeline := <span class="hljs-built_in">make</span>([]bson.M, <span class="hljs-number">0</span>)
err = bson.UnmarshalExtJSON([]<span class="hljs-keyword">byte</span>(strings.TrimSpace(<span class="hljs-string">`
    [
        { &quot;$group&quot;: {
            &quot;_id&quot;: null,
            &quot;Total&quot;: { &quot;$sum&quot;: 1 }
        } },
        { &quot;$project&quot;: {
            &quot;Total&quot;: 1,
            &quot;_id&quot;: 0
        } }
    ]
`</span>)), <span class="hljs-literal">true</span>, &amp;pipeline)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    log.Fatal(err.Error())
}
</code></pre><p>Pada kode lanjutan berikut, method <code>.Aggregate()</code> dipanggil dan disisipkan pipeline-nya.</p><pre><code class="lang-go">csr, err := db.Collection(<span class="hljs-string">&quot;student&quot;</span>).Aggregate(ctx, pipeline)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    log.Fatal(err.Error())
}
<span class="hljs-keyword">defer</span> csr.Close(ctx)

result := <span class="hljs-built_in">make</span>([]bson.M, <span class="hljs-number">0</span>)
<span class="hljs-keyword">for</span> csr.Next(ctx) {
    <span class="hljs-keyword">var</span> row bson.M
    err := csr.Decode(&amp;row)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err.Error())
    }

    result = <span class="hljs-built_in">append</span>(result, row)
}

<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result) &gt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">&quot;Total :&quot;</span>, result[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;Total&quot;</span>])
}
</code></pre><hr><ul><li><a href="https://github.com/mongodb/mongo-go-driver"target="_blank">Mongo Go Driver</a>, by MongoDB Team, Apache-2.0 license</li></ul><hr><div class="source-code-link"><div class="source-code-link-message">Source code praktek pada bab ini tersedia di Github</div><a href="https://github.com/novalagung/dasarpemrogramangolang/tree/master/chapter-A.54-mongodb"target="_blank">https://github.com/novalagung/dasarpemrogramangolang/.../chapter-A.54...</a></div></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title">results matching ""</h1></div><div class="no-results"><h1 class="search-results-title">No results matching ""</h1></div></div></div></div></div></div><a href="53-sql.html"class="navigation navigation-prev"aria-label="Previous page: A.53. SQL"></a><a href="55-unit-test.html"class="navigation navigation-next"aria-label="Next page: A.55. Unit Test"></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{title:"A.54. NoSQL MongoDB",level:"1.2.54",depth:2,next:{title:"A.55. Unit Test",level:"1.2.55",depth:2,path:"55-unit-test.md",ref:"55-unit-test.md",articles:[]},previous:{title:"A.53. SQL",level:"1.2.53",depth:2,path:"53-sql.md",ref:"53-sql.md",articles:[]},dir:"ltr"},config:{plugins:["ga","html-minifier","disqus","meta","sitemap","scripts"],styles:{website:"styles/website.css"},pluginsConfig:{disqus:{useIdentifier:!1,shortName:"dasarpemrogramangolang"},meta:{content:"",data:[{name:"google-site-verification",content:"UZnxS2Dk3fm2_Elms3a__56Q_oQ3sQ1h0SVXXlHSmbE"},{name:"og:image",content:"https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"},{name:"twitter:image",content:"https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"}],name:""},scripts:{files:[]},search:{},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!0,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},fontsettings:{theme:"white",family:"sans",size:2},highlight:{},sitemap:{hostname:"https://dasarpemrogramangolang.novalagung.com/"},ga:{configuration:"auto",token:"UA-27602984-29"},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1}},theme:"default",lunr:{maxIndexSize:1e9},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},variables:{},gitbook:"*"},file:{path:"54-mongodb.md",mtime:"2019-07-25T04:59:34.028Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2019-07-29T08:35:13.592Z"},basePath:".",book:{language:""}})})</script></div><script src="gitbook/gitbook.js"></script><script src="gitbook/theme.js"></script><script src="gitbook/gitbook-plugin-ga/plugin.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="gitbook/gitbook-plugin-search/search-engine.js"></script><script src="gitbook/gitbook-plugin-search/search.js"></script><script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script></body></html>